# frozen_string_literal: true

rows = [
  #"=cmd|'/C calc'!A0", # Ok
  # "@SUM(1+1)*cmd|' /C calc'!A0", # no
  # "+thespanishinquisition(cmd|'/c calc.exe'!A", # no
  #"=cmd|'/C calc'!A0",
  "{=cmd|'/C calc'!A0}", # Not ok
  # "+10+20+cmd|' /C calc'!A0", # Ok on macOS
].freeze

xlsx_package.use_shared_strings = true

wb = xlsx_package.workbook

wb.add_worksheet(name: 'Test') do |sheet|
  sheet.add_row(rows)
  sheet.sheet_pr.tab_color = 'FFFF6666'
  sheet.sheet_pr.tab_color = 'FF66FF66'
end
